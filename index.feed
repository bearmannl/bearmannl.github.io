{
    "version" : "https://jsonfeed.org/version/1.1",
    "title" : "Bearman.NL",
    "description": "This is the main blog of the author Mike Beerman.",
    "home_page_url" : "https://bearman.nl/",
    "feed_url" : "https://bearman.nl/index.feed",
    "icon" : "https://bearman.nl/apple-touch-icon.png",
    "favicon" : "https://bearman.nl/favicon.ico",
    "author" : {
        "name" : "Mike Beerman",
        "url": "https://github.com/bearmannl",
        "avatar": "https://bearman.nl/images/bnl_logo.jpg"
    },
    "items" : [
    {
        "title" : "Firewall Port Status Test Script",
        "date_published" : "2017-08-19T11:56:45+02:00",
        "date_modified" : "2017-08-19T11:56:45+02:00",
        "id" : "https://bearman.nl/2017/08/19/firewall-port-status-test-script/",
        "url" : "https://bearman.nl/2017/08/19/firewall-port-status-test-script/",
        "summary": "Recently I had some issues at a customer project where, due to the complexity of the environment, sometimes firewall ports were closed after they had initially been added to the rules list. This caused unexpected errors for SharePoint, of which we were unaware at the time that these were due to firewall issues.\nWhile analyzing the issue I came across the Test-NetConnection PowerShell command, which I used to manually verify the issue on one server.",
        "content_html" : "\u003cp\u003eRecently I had some issues at a customer project where, due to the complexity of the environment, sometimes firewall ports were closed after they had initially been added to the rules list. This caused unexpected errors for SharePoint, of which we were unaware at the time that these were due to firewall issues.\u003c/p\u003e\n\u003cp\u003eWhile analyzing the issue I came across the Test-NetConnection PowerShell command, which I used to manually verify the issue on one server. However when the time came to repeat the command on several servers I started automating things with my own script. Soon enough the project manager asked me if I could output the results of my script to Excel and send him the files by mail.\u003c/p\u003e\n\u003cp\u003eLogging into several servers to collate the results and manually mail them seemed like a task that could be handled better, so once again I started to redesign and automate the process.\u003c/p\u003e\n\u003cp\u003eWhat resulted is a script with which you can map out local servers and their outbound server connections by port numbers. You can then run the script (scheduled if you want) on each server locally and it will output to a .htm file. I\u0026rsquo;ve configured it to output it to an IIS hosted file, so the IT operations guys can check the firewall status remotely whenever they want.\u003c/p\u003e\n\u003cp\u003eObviously scheduling a check to ensure firewall ports are still open is not ideal, but should you need it I hope my work will save you some effort!\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/bearmannl/posh/blob/master/Scripts/Test-NetConnections.ps1\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eTest-NetConnections.ps1\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://github.com/bearmannl/posh/blob/master/Scripts/Test-NetConnections.json\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eTest-NetConnections.json\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n",
        "language": "en"
    },
    {
        "title" : "Sharepoint ULS Log Files Empty",
        "date_published" : "2017-04-18T13:58:57+02:00",
        "date_modified" : "2017-04-18T13:58:57+02:00",
        "id" : "https://bearman.nl/2017/04/18/sharepoint-uls-log-files-empty/",
        "url" : "https://bearman.nl/2017/04/18/sharepoint-uls-log-files-empty/",
        "summary": "Ran into an annoying issue today where a SharePoint server was not writing trace log messages, the result was a log directory with 0 bytes logging files.\nIncidentally I found a Event Log error with the code:\n\u0026ldquo;A Session \u0026ldquo;WSSUSAGESESSION15\u0026rdquo; failed to start with the following error: 0xC0000022\u0026rdquo;\nOther posts mention adding the service account (or the WSS_WPG group) for the \u0026lsquo;SharePoint Tracing Service\u0026rsquo; Windows Service to the administrators group, tested that, this indeed fixes the problem.",
        "content_html" : "\u003cp\u003eRan into an annoying issue today where a SharePoint server was not writing trace log messages, the result was a log directory with 0 bytes logging files.\u003c/p\u003e\n\u003cp\u003eIncidentally I found a Event Log error with the code:\u003cbr\u003e\n\u0026ldquo;A Session \u0026ldquo;WSSUSAGESESSION15\u0026rdquo; failed to start with the following error: 0xC0000022\u0026rdquo;\u003c/p\u003e\n\u003cp\u003eOther posts mention adding the service account (or the WSS_WPG group) for the \u0026lsquo;SharePoint Tracing Service\u0026rsquo; Windows Service to the administrators group, tested that, this indeed fixes the problem. However this does not conform to the principle of least privileged accounts.\u003c/p\u003e\n\u003cp\u003eFinally I found that the \u0026lsquo;Performance Log Users\u0026rsquo; security group provides the correct permissions to allow a service to write trace log information.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAdded the service account using commandline \u0026ldquo;net localgroup \u0026ldquo;Performance Log Users\u0026rdquo; \u0026ldquo;domain\\username\u0026rdquo; /add\u0026rdquo;\u003c/li\u003e\n\u003cli\u003eRestarted the \u0026lsquo;SharePoint Tracing Service\u0026rsquo; Windows Service, problem solved with least amount of privileges!\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePS. Adding the WSS_WPG security group to the performance log users group \u003cem\u003edoes not\u003c/em\u003e solve the issue.\u003c/p\u003e\n",
        "language": "en"
    }
    {
        "title" : "Creators Update 2 Microsoft Edge Google Inet_e_resource_not_found",
        "date_published" : "2017-04-13T12:12:02+02:00",
        "date_modified" : "2017-04-13T12:12:02+02:00",
        "id" : "https://bearman.nl/2017/04/13/creators-update-2-microsoft-edge-google-inet_e_resource_not_found/",
        "url" : "https://bearman.nl/2017/04/13/creators-update-2-microsoft-edge-google-inet_e_resource_not_found/",
        "summary": "Since the Creators Update navigating to any Google site (google.com, google.co.uk, google.nl, etc.) results in an INET_E_RESOURCE_NOT_FOUND error, only on my work laptop, none of my other devices which I\u0026rsquo;ve also upgraded.\nThis only happened with Google, no other site had this issue\u0026hellip; furthermore I could reach Google(.com) fine via Ping from commandline, Internet Explorer, FireFox and Chrome\u0026hellip;\nCleared my (Edge) browser cache, history, etc. no results. Everything was working fine until the Creators Update.",
        "content_html" : "\u003cp\u003eSince the Creators Update navigating to any Google site (google.com, google.co.uk, google.nl, etc.) results in an INET_E_RESOURCE_NOT_FOUND error, only on my work laptop, none of my other devices which I\u0026rsquo;ve also upgraded.\u003c/p\u003e\n\u003cp\u003eThis \u003cem\u003eonly\u003c/em\u003e happened with Google, no other site had this issue\u0026hellip; furthermore I could reach Google(.com) fine via Ping from commandline, Internet Explorer, FireFox and Chrome\u0026hellip;\u003c/p\u003e\n\u003cp\u003eCleared my (Edge) browser cache, history, etc. no results. Everything was working fine until the Creators Update.\u003c/p\u003e\n\u003cp\u003eI reported the issue via the Feedback Hub, \u003cdel\u003ebut obviously that\u0026rsquo;s no guarantee\u003c/del\u003e that I would have my Edge browser working with Google as my default search engine\u0026hellip; and I so much like Edge with Google as the default search engine!\u003c/p\u003e\n\u003cp\u003eSo I started to pick through my Event Log one error at a time, fixing minor issues every step of the way. Including the following DCOM error, specifically for the RuntimeBroker service:\u003cbr\u003e\n\u0026ldquo;\u003cem\u003eThe application-specific permission settings do not grant Local Activation permission for the COM Server application with CLSID {D63B10C5-BB46-4990-A94F-E40B9D520160} and APPID {9CA88EE3-ACB7-47C8-AFC4-AB702511C276} to the user NT AUTHORITY\\LOCAL SERVICE SID (S-1-5-19) from address LocalHost (Using LRPC) running in the application container Unavailable SID (Unavailable). This security permission can be modified using the Component Services administrative tool.\u003c/em\u003e\u0026rdquo;\u003cbr\u003e\n\u003cimg class=\"tw-inline\" loading=\"lazy\" src=\"/images/2017/04/DCOM-300x197.png\"  sizes=\"auto\" alt=\"DCOM\"  \u003e\u003c/p\u003e\n\u003cp\u003eAs a SharePoint consultant I come across this type of DCOM error quite regularly:\u003cbr\u003e\n\u003ca href=\"https://support.microsoft.com/en-us/help/920783/event-id-error-messages-10016-and-10017-are-logged-in-the-system-log-after-you-install-windows-sharepoint-services-3.0\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://support.microsoft.com/en-us/help/920783/event-id-error-messages-10016-and-10017-are-logged-in-the-system-log-after-you-install-windows-sharepoint-services-3.0\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIn order to fix the error, first take ownership (right click, permissions, advanced, take ownership) of the following registry keys via RegEdit:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eHKEY_CLASSES_ROOT\\AppID\\{9CA88EE3-ACB7-47c8-AFC4-AB702511C276}\u003c/li\u003e\n\u003cli\u003eHKEY_CLASSES_ROOT\\CLSID\\{D63B10C5-BB46-4990-A94F-E40B9D520160}\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThen ensure you provide the SYSTEM account with local launch \u0026amp; local activation permissions, refer to the Microsoft Support link above if you need specific steps to do so. When prompted that editing these permissions requires you to remove an unrecognized account from the permissions list, click remove. Since the application wasn\u0026rsquo;t functioning properly anyway I figured\u0026hellip; what the hell\u0026hellip; and it\u0026rsquo;s working fine right now.\u003cbr\u003e\n\u003cimg class=\"tw-inline\" loading=\"lazy\" src=\"/images/2017/04/DCOM_2-300x205.png\"  sizes=\"auto\" alt=\"DCOM 2\"  \u003e\u003c/p\u003e\n\u003cp\u003eAfter \u003cdel\u003efixing this\u003c/del\u003e I also noticed the login screen no longer waits 5 seconds before accepting my PIN, \u003cdel\u003etwo for the price of one\u003c/del\u003e!\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eUPDATE 19-04-2017:\u003c/strong\u003e\u003cbr\u003e\nApparently I was too quick in releasing my post, above did not fix the Google issue. (it \u003cem\u003edid\u003c/em\u003e however fix the slowdown in accepting my PIN)\u003c/p\u003e\n\u003cp\u003eAs provided by Microsoft the issue can be worked around in two ways until they release a fix:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eType about:flags in the address bar. Scroll down to the Networking section (near the bottom) and uncheck Enable TCP Fast Open, \u003cem\u003ethen restart the browser\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003eUse InPrivate Browsing when using Edge.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhat the feature does:\u003cbr\u003e\n\u003ca href=\"https://www.windowscentral.com/enable-tcp-fast-open-microsoft-edge-faster-page-load-times\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehttps://www.windowscentral.com/enable-tcp-fast-open-microsoft-edge-faster-page-load-times\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eI did disable this feature, I just didn\u0026rsquo;t restart my browser afterwards\u0026hellip; this led me to believe the above fix actually resolved my issue. \u003cstrong\u003eKudo\u0026rsquo;s to Microsoft\u003c/strong\u003e for providing a workaround via the Feedback Hub!\u003c/p\u003e\n",
        "language": "en"
    },
    {
        "title" : "Creators Update 1 Remoteapp and Desktop Connection Gateway Unavailable",
        "date_published" : "2017-04-10T13:11:47+02:00",
        "date_modified" : "2017-04-10T13:11:47+02:00",
        "id" : "https://bearman.nl/2017/04/10/creators-update-1-remoteapp-and-desktop-connection-gateway-unavailable/",
        "url" : "https://bearman.nl/2017/04/10/creators-update-1-remoteapp-and-desktop-connection-gateway-unavailable/",
        "summary": "Last week I upgraded all my personal Windows 10 devices to build 1703 (Creators Update) and after a few days of testing I was convinced this build is solid enough to upgrade my work laptop as well\u0026hellip; true so far except for one minor issue! When I had to connect to a client\u0026rsquo;s RemoteApp and Desktop Connection gateway, which they host on Windows Server 2008R2, I got the following error: \u0026ldquo;Your computer can’t connect to the Remote Desktop Gateway server.",
        "content_html" : "\u003cp\u003eLast week I upgraded all my personal Windows 10 devices to build 1703 (Creators Update) and after a few days of testing I was convinced this build is solid enough to upgrade my work laptop as well\u0026hellip; true so far except for one minor issue! When I had to connect to a client\u0026rsquo;s RemoteApp and Desktop Connection gateway, which they host on Windows Server 2008R2, I got the following error: \u0026ldquo;\u003cem\u003eYour computer can’t connect to the Remote Desktop Gateway server. Contact your network administrator for assistance.\u003c/em\u003e\u0026rdquo; I don\u0026rsquo;t know exactly what changed in this Windows build with regards to the RDP client, however I worked around it by restoring the following two files to the Windows System32 folder, from the Windows.old folder:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003emstsc.exe\u003c/li\u003e\n\u003cli\u003emstsccax.dll\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg class=\"tw-inline\" loading=\"lazy\" src=\"/images/2017/04/MSTSC_replace-300x300.png\"  sizes=\"auto\" alt=\"MTSC replace\"  \u003e\u003c/p\u003e\n\u003cp\u003eAs you can see from the file replace details, the files have changed somewhat with this new build. I don\u0026rsquo;t yet know if this also occurs with RDS hosted on 2012 and up, if it does please leave a comment below. Obviously not a permanent solution, but unfortunately I don\u0026rsquo;t have the luxury of waiting for one.\u003c/p\u003e\n",
        "language": "en"
    },
    {
        "title" : "Password Change Notification Script",
        "date_published" : "2016-06-23T14:09:50+02:00",
        "date_modified" : "2016-06-23T14:09:50+02:00",
        "id" : "https://bearman.nl/2016/06/23/password-change-notification-script/",
        "url" : "https://bearman.nl/2016/06/23/password-change-notification-script/",
        "summary": "Version 1.4Recently I found myself in need of a password change notification script. What do all efficient/lazy administrators do when they need a script for any purpose? Right, I searched one online, downloaded it, checked it, suppressed any desire to fiddle with it and then scheduled it to run. For those interested, I used the script provided by Robert Pearman over at the Technet Gallery. For Office365 compatibility check his post here…",
        "content_html" : "\u003ch1 id=\"version-14\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#version-14\" class=\"header-mark\" aria-label=\"Header mark for 'Version 1.4'\"\u003e\u003c/a\u003eVersion 1.4\u003c/h1\u003e\u003cp\u003eRecently I found myself in need of a password change notification script. What do all efficient/lazy administrators do when they need a script for any purpose? Right, I searched one online, downloaded it, \u003cem\u003echecked it\u003c/em\u003e, suppressed any desire to fiddle with it and then scheduled it to run. For those interested, I used the script provided by Robert Pearman \u003ca href=\"https://gallery.technet.microsoft.com/Password-Expiry-Email-177c3e27\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eover at the Technet Gallery\u003c/a\u003e. For Office365 compatibility check \u003ca href=\"https://windowsserveressentials.com/2015/01/23/office-365-email-password-reminder/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003ehis post here\u003c/a\u003e…\u003c/p\u003e\n\u003ch1 id=\"version-20\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#version-20\" class=\"header-mark\" aria-label=\"Header mark for 'Version 2.0'\"\u003e\u003c/a\u003eVersion 2.0\u003c/h1\u003e\u003cp\u003eBut then… that annoying little OCD gene (those of you who have it surely recognize it!) crept up on me today and I started fiddling with it anyway. I told myself the script needed to include some customizations for my company, but who am I kidding, I would lose sleep if I didn’t give in to my OCD quirks every once in a while. In general, I changed the script to include a proper description block, parameters, cleanup of casing for variables and refactoring of some Boolean uses to shorten the if statements. The part I needed to change specifically for Silverside was the Filter for the Get-ADUser command, this allows me to filter out Admin accounts in our organization:\u003c/p\u003e\n\u003cdiv class=\"code-block highlight is-open show-line-numbers  tw-group tw-my-2\"\u003e\r\n  \u003cdiv class=\"\r\n    code-block-title \r\n    \r\n    tw-flex \r\n    tw-flex-row \r\n    tw-justify-between \r\n    tw-w-full tw-bg-bgColor-secondary\r\n    \"\u003e      \r\n    \u003cbutton \r\n      class=\"\r\n        tw-select-none \r\n        tw-mx-2 \r\n        tw-block\r\n        group-[.is-open]:tw-rotate-90\r\n        tw-transition-[transform] \r\n        tw-duration-500 \r\n        tw-ease-in-out\r\n        print:!tw-hidden\"\r\n      disabled\r\n      aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n    \u003cdiv class=\"code-block-title-bar tw-w-full\"\u003e\r\n      \u003cp class=\"tw-select-none !tw-my-1\"\u003epowershell\u003c/p\u003e\r\n    \u003c/div\u003e\r\n    \u003cdiv class=\"tw-flex\"\u003e\r\n      \u003cbutton \r\n        class=\"\r\n          line-number-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.show-line-numbers]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle line numbers\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M61.77 401l17.5-20.15a19.92 19.92 0 0 0 5.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h22.83a157.41 157.41 0 0 0-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33 0 15.94 2.44 15.94 9.09 0 4.72-4.2 8.22-14.36 8.22a41.54 41.54 0 0 1-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16 0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM16 160h64a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H64V40a8 8 0 0 0-8-8H32a8 8 0 0 0-7.14 4.42l-8 16A8 8 0 0 0 24 64h8v64H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8zm-3.91 160H80a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44 0-29.06-25-39.56-44.47-39.56-21.36 0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44 0 0 1 9.46-3.84c3.33 0 9.28 1.56 9.28 8.75C51 248.19 0 257.31 0 304.59v4C0 316 5.08 320 12.09 320z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n      \u003cbutton \r\n        class=\"\r\n          wrap-code-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.is-wrap]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle code wrap\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n      \r\n      \u003cbutton \r\n        class=\"\r\n          copy-code-button\r\n          tw-select-none\r\n          tw-mx-2 \r\n          tw-hidden\r\n          group-[.is-open]:tw-block\r\n          hover:tw-text-fgColor-link \r\n          print:!tw-hidden\"\r\n        title=\"Copy code\"\u003e\r\n          \u003cspan class=\"copy-icon tw-block\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n          \u003cspan class=\"check-icon tw-hidden\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n      \u003c/button\u003e\r\n        \r\n      \u003cbutton \r\n        class=\"\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-block \r\n          group-[.is-open]:tw-hidden \r\n          print:!tw-hidden\" \r\n        disabled\r\n        aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n    \u003c/div\u003e\r\n  \u003c/div\u003e\r\n  \u003cpre style=\"counter-reset: codeblock;\" class=\"tw-block tw-m-0 tw-p-0\"\u003e\u003ccode \r\n    id=\"codeblock-id-1\" \r\n    class=\"\r\n      chroma \r\n      !tw-block \r\n      tw-p-0\r\n      tw-m-0\r\n      tw-transition-[max-height] \r\n      tw-duration-500 \r\n      tw-ease-in-out \r\n      group-[.is-closed]:!tw-max-h-0 \r\n      group-[.is-wrap]:tw-text-wrap\r\n      tw-overflow-y-hidden\r\n      tw-overflow-x-auto\r\n      tw-scrollbar-thin\r\n      \"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"err\"\u003e…\u003c/span\u003e \u003cspan class=\"o\"\u003e-and\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eUserPrincipalName\u003c/span\u003e \u003cspan class=\"o\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;adm*\u0026#39;\u003c/span\u003e \u003cspan class=\"err\"\u003e…\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eOverall the script is now easier to deploy out of the box with the use of parameters (including defaults), so long as you remember to adjust \u003cem\u003e\u003cstrong\u003eat least\u003c/strong\u003e\u003c/em\u003e the \u003cstrong\u003e$smtpServer\u003c/strong\u003e and \u003cstrong\u003e$from\u003c/strong\u003e variables under the config section:\u003c/p\u003e\n\u003cdiv class=\"code-block highlight is-open show-line-numbers  tw-group tw-my-2\"\u003e\r\n  \u003cdiv class=\"\r\n    code-block-title \r\n    \r\n    tw-flex \r\n    tw-flex-row \r\n    tw-justify-between \r\n    tw-w-full tw-bg-bgColor-secondary\r\n    \"\u003e      \r\n    \u003cbutton \r\n      class=\"\r\n        tw-select-none \r\n        tw-mx-2 \r\n        tw-block\r\n        group-[.is-open]:tw-rotate-90\r\n        tw-transition-[transform] \r\n        tw-duration-500 \r\n        tw-ease-in-out\r\n        print:!tw-hidden\"\r\n      disabled\r\n      aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n    \u003cdiv class=\"code-block-title-bar tw-w-full\"\u003e\r\n      \u003cp class=\"tw-select-none !tw-my-1\"\u003epowershell\u003c/p\u003e\r\n    \u003c/div\u003e\r\n    \u003cdiv class=\"tw-flex\"\u003e\r\n      \u003cbutton \r\n        class=\"\r\n          line-number-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.show-line-numbers]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle line numbers\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M61.77 401l17.5-20.15a19.92 19.92 0 0 0 5.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h22.83a157.41 157.41 0 0 0-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33 0 15.94 2.44 15.94 9.09 0 4.72-4.2 8.22-14.36 8.22a41.54 41.54 0 0 1-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16 0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM16 160h64a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H64V40a8 8 0 0 0-8-8H32a8 8 0 0 0-7.14 4.42l-8 16A8 8 0 0 0 24 64h8v64H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8zm-3.91 160H80a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44 0-29.06-25-39.56-44.47-39.56-21.36 0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44 0 0 1 9.46-3.84c3.33 0 9.28 1.56 9.28 8.75C51 248.19 0 257.31 0 304.59v4C0 316 5.08 320 12.09 320z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n      \u003cbutton \r\n        class=\"\r\n          wrap-code-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.is-wrap]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle code wrap\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n      \r\n      \u003cbutton \r\n        class=\"\r\n          copy-code-button\r\n          tw-select-none\r\n          tw-mx-2 \r\n          tw-hidden\r\n          group-[.is-open]:tw-block\r\n          hover:tw-text-fgColor-link \r\n          print:!tw-hidden\"\r\n        title=\"Copy code\"\u003e\r\n          \u003cspan class=\"copy-icon tw-block\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n          \u003cspan class=\"check-icon tw-hidden\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n      \u003c/button\u003e\r\n        \r\n      \u003cbutton \r\n        class=\"\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-block \r\n          group-[.is-open]:tw-hidden \r\n          print:!tw-hidden\" \r\n        disabled\r\n        aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n    \u003c/div\u003e\r\n  \u003c/div\u003e\r\n  \u003cpre style=\"counter-reset: codeblock;\" class=\"tw-block tw-m-0 tw-p-0\"\u003e\u003ccode \r\n    id=\"codeblock-id-2\" \r\n    class=\"\r\n      chroma \r\n      !tw-block \r\n      tw-p-0\r\n      tw-m-0\r\n      tw-transition-[max-height] \r\n      tw-duration-500 \r\n      tw-ease-in-out \r\n      group-[.is-closed]:!tw-max-h-0 \r\n      group-[.is-wrap]:tw-text-wrap\r\n      tw-overflow-y-hidden\r\n      tw-overflow-x-auto\r\n      tw-scrollbar-thin\r\n      \"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$smtpServer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;mail.yourdomain.local\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$from\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Your Company IT noreply@yourdomain.com\u0026#34;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\r\n\u003c/div\u003e\r\n\u003ch1 id=\"the-script\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#the-script\" class=\"header-mark\" aria-label=\"Header mark for 'The script'\"\u003e\u003c/a\u003eThe script\u003c/h1\u003e\u003cp\u003eAs you no doubt found this post after efficiently searching for a free scipt online, feel free to use, I hope it saves you some time. Just remember to include the original author as described in the comments. You can also find the latest version at my GitHub account, \u003ca href=\"https://github.com/bearmannl/posh/blob/master/Scripts/Send-PasswordChangeNotification.ps1\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eSend-PasswordChangeNotification.ps1\u003c/a\u003e\u003c/p\u003e\n\u003cdiv class=\"code-block highlight is-closed show-line-numbers  tw-group tw-my-2\"\u003e\r\n  \u003cdiv class=\"\r\n    code-block-title \r\n    \r\n    tw-flex \r\n    tw-flex-row \r\n    tw-justify-between \r\n    tw-w-full tw-bg-bgColor-secondary\r\n    \"\u003e      \r\n    \u003cbutton \r\n      class=\"\r\n        tw-select-none \r\n        tw-mx-2 \r\n        tw-block\r\n        group-[.is-open]:tw-rotate-90\r\n        tw-transition-[transform] \r\n        tw-duration-500 \r\n        tw-ease-in-out\r\n        print:!tw-hidden\"\r\n      disabled\r\n      aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n    \u003cdiv class=\"code-block-title-bar tw-w-full\"\u003e\r\n      \u003cp class=\"tw-select-none !tw-my-1\"\u003epowershell\u003c/p\u003e\r\n    \u003c/div\u003e\r\n    \u003cdiv class=\"tw-flex\"\u003e\r\n      \u003cbutton \r\n        class=\"\r\n          line-number-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.show-line-numbers]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle line numbers\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M61.77 401l17.5-20.15a19.92 19.92 0 0 0 5.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h22.83a157.41 157.41 0 0 0-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33 0 15.94 2.44 15.94 9.09 0 4.72-4.2 8.22-14.36 8.22a41.54 41.54 0 0 1-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16 0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM16 160h64a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H64V40a8 8 0 0 0-8-8H32a8 8 0 0 0-7.14 4.42l-8 16A8 8 0 0 0 24 64h8v64H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8zm-3.91 160H80a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44 0-29.06-25-39.56-44.47-39.56-21.36 0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44 0 0 1 9.46-3.84c3.33 0 9.28 1.56 9.28 8.75C51 248.19 0 257.31 0 304.59v4C0 316 5.08 320 12.09 320z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n      \u003cbutton \r\n        class=\"\r\n          wrap-code-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.is-wrap]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle code wrap\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n      \r\n      \u003cbutton \r\n        class=\"\r\n          copy-code-button\r\n          tw-select-none\r\n          tw-mx-2 \r\n          tw-hidden\r\n          group-[.is-open]:tw-block\r\n          hover:tw-text-fgColor-link \r\n          print:!tw-hidden\"\r\n        title=\"Copy code\"\u003e\r\n          \u003cspan class=\"copy-icon tw-block\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n          \u003cspan class=\"check-icon tw-hidden\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n      \u003c/button\u003e\r\n        \r\n      \u003cbutton \r\n        class=\"\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-block \r\n          group-[.is-open]:tw-hidden \r\n          print:!tw-hidden\" \r\n        disabled\r\n        aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n    \u003c/div\u003e\r\n  \u003c/div\u003e\r\n  \u003cpre style=\"counter-reset: codeblock;\" class=\"tw-block tw-m-0 tw-p-0\"\u003e\u003ccode \r\n    id=\"codeblock-id-3\" \r\n    class=\"\r\n      chroma \r\n      !tw-block \r\n      tw-p-0\r\n      tw-m-0\r\n      tw-transition-[max-height] \r\n      tw-duration-500 \r\n      tw-ease-in-out \r\n      group-[.is-closed]:!tw-max-h-0 \r\n      group-[.is-wrap]:tw-text-wrap\r\n      tw-overflow-y-hidden\r\n      tw-overflow-x-auto\r\n      tw-scrollbar-thin\r\n      \"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\u0026lt;#\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.\u003c/span\u003e\u003cspan class=\"sd\"\u003eSYNOPSIS\u003c/span\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Get all users with a soon to expire password and send them a reminder to do so.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.\u003c/span\u003e\u003cspan class=\"sd\"\u003eDESCRIPTION\u003c/span\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    This script gets all users with a soon to expire password and sends them a reminder to do so. This script was originally created by Robert Pearman and posted on the technet gallery. Since modified by Mike Beerman to include changes specific for Silverside. Settings such as the destination SMTP server and From address can only be configured within the script.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.PARAMETER ExpireInDays\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Optional input allowing an override to the number of days at which the script will send a reminder. Defaults to 30 days.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.PARAMETER Logging\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Switch which determines if a seperate CSV logfile should be created. Default to false without the switch.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.PARAMETER LogPath\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Folderpath for the logfile, plain string format.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.PARAMETER Testing\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Switch which determines if the emails should be sent to the test recipient instead of the actual users. Default to false without the switch.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.PARAMETER TestRecipient\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Optional string for setting a different recipient in testing for testing purposes. Will not be used if Testing is not included in the command or email is disabled.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.PARAMETER TestMailDisabled\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Switch for disabling email functionality.\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.\u003c/span\u003e\u003cspan class=\"sd\"\u003eEXAMPLE\u003c/span\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eSend-PasswordChangeNotification.ps1\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003eSend-PasswordChangeNotification.ps1 -Expire 60 -Logging -Logile \u0026#34;C:\\Logs\\PasswordChangeNotifications.csv\u0026#34; -Testing -TestRecipient \u0026#34;yourname@yourdomain.com\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.\u003c/span\u003e\u003cspan class=\"sd\"\u003eLINK\u003c/span\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    https://gallery.technet.microsoft.com/Password-Expiry-Email-177c3e27\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    https://bearman.nl/2016/06/23/password-change-notification-script\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e.\u003c/span\u003e\u003cspan class=\"sd\"\u003eNOTES\u003c/span\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Authors : Mike Beerman\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Company : Silverside\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Date : 2016-06-23\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Version : 2.0\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Authors : Robert Pearman (WSSMB MVP)\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Company : Windows Server Essentials\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Date : 2016-02-03\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e    Version : 1.4\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cm\"\u003e#\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eparam\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"nb\"\u003eValidateRange\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\u003cspan class=\"mf\"\u003e365\u003c/span\u003e\u003cspan class=\"p\"\u003e)][\u003c/span\u003e\u003cspan class=\"no\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$ExpireInDays\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"mf\"\u003e30\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$Logging\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$LogPath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;C:\\Logs\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$Testing\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003estring\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$TestRecipient\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;yourname@yourdomain.com\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eswitch\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\u003cspan class=\"nv\"\u003e$TestMailDisabled\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e##\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Config values\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e##\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$smtpServer\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;mail.yourdomain.local\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$from\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Your Company IT \u0026lt;noreply@yourdomain.com\u0026gt;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$textEncoding\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"no\"\u003eSystem.Text.Encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e]::\u003c/span\u003e\u003cspan class=\"n\"\u003eUTF8\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$logDate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e \u003cspan class=\"n\"\u003e-Format\u003c/span\u003e \u003cspan class=\"n\"\u003eyyyyMMdd\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$LogPath\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$LogPath\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eTrimEnd\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\\\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$logFile\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$LogPath\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\\PasswordChangeNotifications.csv\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e##\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e#Initiate PowerShell session\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e##\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Set threading\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$ver\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$host\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eSelect-Object\u003c/span\u003e \u003cspan class=\"n\"\u003eVersion\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$ver\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eVersion\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eMajor\u003c/span\u003e \u003cspan class=\"o\"\u003e-gt\u003c/span\u003e \u003cspan class=\"mf\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"nv\"\u003e$Host\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eRunspace\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eThreadOptions\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;ReuseThread\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Load Active Directory PowerShell snap-in\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eImport-Module\u003c/span\u003e \u003cspan class=\"n\"\u003eActiveDirectory\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eWrite-Verbose\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;[{0}] - AD PowerShell SnapIn loaded\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e-f\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e \u003cspan class=\"n\"\u003e-Format\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$verbosePreference\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Continue\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Check Logging Settings\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$Logging\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Test Log Folder Path and create new directory if false\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eTest-Path\u003c/span\u003e \u003cspan class=\"nv\"\u003e$LogPath\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e# Create CSV File and Headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eNew-Item\u003c/span\u003e \u003cspan class=\"nv\"\u003e$LogPath\u003c/span\u003e \u003cspan class=\"n\"\u003e-ItemType\u003c/span\u003e \u003cspan class=\"n\"\u003eDirectory\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eOut-Null\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eWrite-Verbose\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;[{0}] - New folder created at [{1}]\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e-f\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e \u003cspan class=\"n\"\u003e-Format\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$LogPath\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Test Log File Path and create new file if false\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eTest-Path\u003c/span\u003e \u003cspan class=\"nv\"\u003e$logFile\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e# Create CSV File and Headers\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eNew-Item\u003c/span\u003e \u003cspan class=\"nv\"\u003e$logFile\u003c/span\u003e \u003cspan class=\"n\"\u003e-ItemType\u003c/span\u003e \u003cspan class=\"n\"\u003eFile\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eOut-Null\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eAdd-Content\u003c/span\u003e \u003cspan class=\"nv\"\u003e$logFile\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Date,Name,EmailAddress,DaystoExpire,ExpiresOn,Notified\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eWrite-Verbose\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;[{0}] - New logfile created at [{1}]\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e-f\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e \u003cspan class=\"n\"\u003e-Format\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$logFile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c\"\u003e# End Logging Check\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$DefaultmaxPasswordAge\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-ADDefaultDomainPasswordPolicy\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eMaxPasswordAge\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Get Users From AD who are Enabled, Passwords Expire and are Not Currently Expired\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$users\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eGet-ADUser\u003c/span\u003e \u003cspan class=\"n\"\u003e-Filter\u003c/span\u003e \u003cspan class=\"p\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003e-Properties\u003c/span\u003e \u003cspan class=\"n\"\u003eName\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePasswordNeverExpires\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePasswordExpired\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ePasswordLastSet\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eEmailAddress\u003c/span\u003e \u003cspan class=\"p\"\u003e|\u003c/span\u003e \u003cspan class=\"nb\"\u003eWhere-Object\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eEnabled\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"vm\"\u003e$true\u003c/span\u003e \u003cspan class=\"o\"\u003e-and\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ePasswordNeverExpires\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"vm\"\u003e$false\u003c/span\u003e \u003cspan class=\"o\"\u003e-and\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003epasswordexpired\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"vm\"\u003e$false\u003c/span\u003e \u003cspan class=\"o\"\u003e-and\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eUserPrincipalName\u003c/span\u003e \u003cspan class=\"o\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;adm*\u0026#39;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# Process Each User for Password Expiry\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eforeach\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$user\u003c/span\u003e \u003cspan class=\"k\"\u003ein\u003c/span\u003e \u003cspan class=\"nv\"\u003e$users\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$name\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eName\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003eEmailAddress\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$passwordSetDate\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"py\"\u003ePasswordLastSet\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$PasswordPol\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-ADUserResultantPasswordPolicy\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$sent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026#34;\u003c/span\u003e \u003cspan class=\"c\"\u003e# Reset Sent Flag\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Check for Fine Grained Password\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e \u003cspan class=\"o\"\u003e-ne\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$PasswordPol\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$maxPasswordAge\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$PasswordPol\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eMaxPasswordAge\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e# No FGP set to Domain Default\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$maxPasswordAge\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$DefaultmaxPasswordAge\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$expiresOn\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$passwordSetDate\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"nv\"\u003e$maxPasswordAge\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$today\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eNew-TimeSpan\u003c/span\u003e \u003cspan class=\"n\"\u003e-Start\u003c/span\u003e \u003cspan class=\"nv\"\u003e$today\u003c/span\u003e \u003cspan class=\"n\"\u003e-End\u003c/span\u003e \u003cspan class=\"nv\"\u003e$expiresOn\u003c/span\u003e\u003cspan class=\"p\"\u003e).\u003c/span\u003e\u003cspan class=\"py\"\u003eDays\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Set Greeting based on Number of Days to Expiry.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Check Number of Days to Expiry\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$messageDays\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$messageDays\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-gt\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;1\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$messageDays\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;in \u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e \u003cspan class=\"p\"\u003e+\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34; days.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$messageDays\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;today.\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Email Subject Set Here\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e\u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Your password will expire \u003c/span\u003e\u003cspan class=\"nv\"\u003e$messageDays\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Email Body Set Here, Note You can use HTML, including Images.\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nv\"\u003e$body\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    Dear \u003c/span\u003e\u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;p\u0026gt; Your Password will expire \u003c/span\u003e\u003cspan class=\"nv\"\u003e$messageDays\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026lt;br\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    To change your password on a PC press CTRL ALT Delete and choose Change Password \u0026lt;br\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;p\u0026gt;Thanks, \u0026lt;br\u0026gt; \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    Your Comany IT Administrators\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"s2\"\u003e    \u0026lt;/p\u0026gt;\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# If Testing Is Enabled - Email Administrator\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$Testing\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$TestRecipient\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c\"\u003e# End Testing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# If a user has no email address listed\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$TestRecipient\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\u003cspan class=\"c\"\u003e# End No Valid Email\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c\"\u003e# Send Email Message\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e((\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;0\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-or\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;14\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e-or\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"nv\"\u003e$ExpireInDays\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$sent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Yes\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e# If Logging is Enabled Log Details\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$Logging\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eAdd-Content\u003c/span\u003e \u003cspan class=\"nv\"\u003e$logFile\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$logDate\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$expiresOn\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sent\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eWrite-Verbose\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;[{0}] - Entry added to logfile for user [{1}]\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e-f\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e \u003cspan class=\"n\"\u003e-Format\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUserPrincipalName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e# Send Email Message if not disabled by switch\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"vm\"\u003e$null\u003c/span\u003e \u003cspan class=\"o\"\u003e-eq\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$TestMailDisabled\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eSend-Mailmessage\u003c/span\u003e \u003cspan class=\"n\"\u003e-SmtpServer\u003c/span\u003e \u003cspan class=\"nv\"\u003e$smtpServer\u003c/span\u003e \u003cspan class=\"n\"\u003e-From\u003c/span\u003e \u003cspan class=\"nv\"\u003e$from\u003c/span\u003e \u003cspan class=\"n\"\u003e-To\u003c/span\u003e \u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e \u003cspan class=\"n\"\u003e-Subject\u003c/span\u003e \u003cspan class=\"nv\"\u003e$subject\u003c/span\u003e \u003cspan class=\"n\"\u003e-Body\u003c/span\u003e \u003cspan class=\"nv\"\u003e$body\u003c/span\u003e \u003cspan class=\"n\"\u003e-BodyAsHTML\u003c/span\u003e \u003cspan class=\"n\"\u003e-Priority\u003c/span\u003e \u003cspan class=\"n\"\u003eHigh\u003c/span\u003e \u003cspan class=\"n\"\u003e-Encoding\u003c/span\u003e \u003cspan class=\"nv\"\u003e$textEncoding\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eWrite-Verbose\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;[{0}] - Email sent to [{1}]\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e-f\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e \u003cspan class=\"n\"\u003e-Format\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c\"\u003e# End Send Message\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e# Log Non Expiring Password\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nv\"\u003e$sent\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;No\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"c\"\u003e# If Logging is Enabled Log Details\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$Logging\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eAdd-Content\u003c/span\u003e \u003cspan class=\"nv\"\u003e$logFile\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"nv\"\u003e$logDate\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$name\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$emailAddress\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$daysToExpire\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$expiresOn\u003c/span\u003e\u003cspan class=\"s2\"\u003e,\u003c/span\u003e\u003cspan class=\"nv\"\u003e$sent\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eWrite-Verbose\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;[{0}] - Entry added to logfile for user [{1}]\u0026#34;\u003c/span\u003e \u003cspan class=\"o\"\u003e-f\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003eGet-Date\u003c/span\u003e \u003cspan class=\"n\"\u003e-Format\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"p\"\u003e),\u003c/span\u003e \u003cspan class=\"nv\"\u003e$user\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eUserPrincipalName\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"c\"\u003e# End User Processing\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$verbosePreference\u003c/span\u003e \u003cspan class=\"p\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;SilentlyContinue\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c\"\u003e# End\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\r\n\u003c/div\u003e\r\n",
        "language": "en"
    },
    {
        "title" : "The Castle the City and the Outlands",
        "date_published" : "2016-06-22T14:36:47+02:00",
        "date_modified" : "2016-06-22T14:36:47+02:00",
        "id" : "https://bearman.nl/2016/06/22/the-castle-the-city-and-the-outlands/",
        "url" : "https://bearman.nl/2016/06/22/the-castle-the-city-and-the-outlands/",
        "summary": "The education sectorIn consultancy we see a wide range of business sectors. From healthcare, to banking, but also the education sector. Yesterday I was providing advice on user adoption and migration strategies for a large educational institute. In attempting to explain the security architecture of Office365 and SharePoint Online I used several metaphors. To summarize what I had told him, my customer offered a metaphor of his own in return which I found to be very effective.",
        "content_html" : "\u003ch1 id=\"the-education-sector\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#the-education-sector\" class=\"header-mark\" aria-label=\"Header mark for 'The education sector'\"\u003e\u003c/a\u003eThe education sector\u003c/h1\u003e\u003cp\u003eIn consultancy we see a wide range of business sectors. From healthcare, to banking, but also the education sector. Yesterday I was providing advice on user adoption and migration strategies for a large educational institute. In attempting to explain the security architecture of Office365 and SharePoint Online I used several metaphors. To summarize what I had told him, my customer offered a metaphor of his own in return which I found to be very effective. The metaphor is one based on medieval times and castle related terms.\u003c/p\u003e\n\u003ch1 id=\"the-medieval-metaphor\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#the-medieval-metaphor\" class=\"header-mark\" aria-label=\"Header mark for 'The medieval metaphor'\"\u003e\u003c/a\u003eThe medieval metaphor\u003c/h1\u003e\u003cp\u003eIn medieval times there was a rough division in security policies based on the layers:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCastle and keep;\u003c/li\u003e\n\u003cli\u003eThe (walled) city surrounding the castle;\u003c/li\u003e\n\u003cli\u003eAll the lands outside of said walls.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg class=\"tw-inline\" loading=\"lazy\" src=\"/2016/06/22/the-castle-the-city-and-the-outlands/CCO.png\" srcset=\"/2016/06/22/the-castle-the-city-and-the-outlands/CCO_hu54ee71bf1c482088d0cff5686db75646_18463_800x0_resize_q75_h2_box_3.webp 800w, /2016/06/22/the-castle-the-city-and-the-outlands/CCO_hu54ee71bf1c482088d0cff5686db75646_18463_1200x0_resize_q75_h2_box_3.webp 1200w, /2016/06/22/the-castle-the-city-and-the-outlands/CCO_hu54ee71bf1c482088d0cff5686db75646_18463_1600x0_resize_q75_h2_box_3.webp 1600w\" sizes=\"auto\" alt=\"CCO\" height=\"337\" width=\"576\"\u003e\u003c/p\u003e\n\u003cp\u003eWithin the castle security measures were strict and centrally managed. All comings and goings were tightly regulated. A city enjoyed the safety provided by castle walls, under the conditions of central regulations by castle administration. However, the city was primarily a civilian zone with itself a decentralized management structure. Giving some freedom to areas such as commerce. The outlying lands had no walls to protect them, yet no rules were enforced from a centralized command structure.\u003c/p\u003e\n\u003ch1 id=\"the-castle-that-is-sharepoint\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#the-castle-that-is-sharepoint\" class=\"header-mark\" aria-label=\"Header mark for 'The castle that is SharePoint'\"\u003e\u003c/a\u003eThe castle that is SharePoint\u003c/h1\u003e\u003cp\u003eIn this case the metaphor was used to reflect a security setup for Office365 and SharePoint. In this scenario we’ve suggested creating a tightly controlled SharePoint environment, where users can mainly collaborate with each other and where functional support / key users determine if changes are needed and how to implement them. Literally, users receive access to readymade sites and libraries, but are unable to create new sites themselves, or customize content types and so on. Yammer is the platform where users are allowed to engage more freely, creating their own groups and inviting users to those groups on their own. This would be the city with walls where users get to interact and invite users through an open gate. The centralized guidelines however state the general purpose for Yammer, without strictly monitoring or enforcing its use. The outlands are herein represented by OneDrive for Business, mysite / personal storage specifically. Where users are allowed to bring in any content, structure it with folders to their own ideas and invite whomever them want for shared content. By no way is OneDrive a clear representation for the outlands since OneDrive is still built on ‘land of the king’, errrr… Office 365. But for the purposes of the design this customer is going for, it fits. True outlands would in fact be user laptops, fileshares, or in older environments SharePoint 2010 Workspaces.\u003c/p\u003e\n\u003ch1 id=\"just-a-useful-tool\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#just-a-useful-tool\" class=\"header-mark\" aria-label=\"Header mark for 'Just a useful tool'\"\u003e\u003c/a\u003eJust a useful tool\u003c/h1\u003e\u003cp\u003eThe metaphor is a tool to help you illustrate complicated IT concepts, by using a common reference. Although it isn’t an exact match for a complicated structure such as Office 365, I bet administrators in medieval times would say the same about running a city state. Use at your own behest!\u003c/p\u003e\n",
        "language": "en"
    },
    {
        "title" : "Custom Domain Names With Azurewebsites",
        "date_published" : "2016-06-16T15:13:27+02:00",
        "date_modified" : "2016-06-16T15:13:27+02:00",
        "id" : "https://bearman.nl/2016/06/16/custom-domain-names-with-azurewebsites/",
        "url" : "https://bearman.nl/2016/06/16/custom-domain-names-with-azurewebsites/",
        "summary": "I\u0026rsquo;ve only recently set up this blog and since it\u0026rsquo;s always busy at work, I don\u0026rsquo;t always have the time to sort out those \u0026rsquo;nice to haves\u0026rsquo;. I\u0026rsquo;m hosting this blog using AzureWebsites, but obviously I use my own domain name. My pain? For the life of me I couldn\u0026rsquo;t figure out the magic rule to rewrite my x.azurewebsites.net url to the proper \u0026lsquo;bearman.nl\u0026rsquo; hostname I\u0026rsquo;m using now. Shame on me, Microsoft consultant couldn\u0026rsquo;t figure out a simple IIS redirect rule\u0026hellip; In my defense, I hadn\u0026rsquo;t really taken the time to do it properly and I had in fact solved it, but in the wrong order.",
        "content_html" : "\u003cp\u003eI\u0026rsquo;ve only recently set up this blog and since it\u0026rsquo;s always busy at work, I don\u0026rsquo;t always have the time to sort out those \u0026rsquo;nice to haves\u0026rsquo;. I\u0026rsquo;m hosting this blog using AzureWebsites, but obviously I use my own domain name. My pain? For the life of me I couldn\u0026rsquo;t figure out the magic rule to rewrite my x.azurewebsites.net url to the proper \u0026lsquo;bearman.nl\u0026rsquo; hostname I\u0026rsquo;m using now. Shame on me, Microsoft consultant couldn\u0026rsquo;t figure out a simple IIS redirect rule\u0026hellip; In my defense, I hadn\u0026rsquo;t really taken the time to do it properly and I had in fact solved it, but in the wrong order. To setup an AzureWebsite using a custom domain you need to configure it in several places:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIn the Azure portal;\u003c/li\u003e\n\u003cli\u003eDNS records with your domain registrar;\u003c/li\u003e\n\u003cli\u003eIn your application, in my case WordPress;\u003c/li\u003e\n\u003cli\u003eAn IIS rule to do the actual rewrite/redirect.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhere to configure in Azure? In the Azure Portal find your Web App settings and under the Routing header click on Custom Domains and SSL. Select Bring External Domain and follow the instructions. Pay attention to using the correct type of DNS records, A records and CNAME records, depending on the correct entry. With your domain registrar find the DNS Manager to actually enter the records. You need to set the awverify.*.azurewebsites.net record with a CNAME to verify your custom domain with Azure. I went and created an A record for my domain to the AzureWebsite. Most registrars provide a warning stating you need to wait a maximum of up to 24 hours before the records are updated, in my case they were available within a minute, this may vary based on the receiving location however. In your application add your custom domain, in the case of WordPress go to General Settings and edit your WordPress Address (URL) and Site Address (URL) accordingly. Finally comes the last bit of magic, the IIS rewrite rule. Kudo\u0026rsquo;s to the \u003ca href=\"http://onthecloud.azurewebsites.net/seo-tip-how-to-block-the-.azurewebsites.net-domain\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eauthor of the solution\u003c/a\u003e for the final makeup of the IIS rule and \u003ca href=\"http://www.devjev.nl/\" target=\"_blank\" rel=\"noopener noreferrer\"\u003eDevJev\u003c/a\u003e for nudging me in the right direction :-)\u003c/p\u003e\n\u003cdiv class=\"code-block highlight is-closed show-line-numbers  tw-group tw-my-2\"\u003e\r\n  \u003cdiv class=\"\r\n    code-block-title \r\n    \r\n    tw-flex \r\n    tw-flex-row \r\n    tw-justify-between \r\n    tw-w-full tw-bg-bgColor-secondary\r\n    \"\u003e      \r\n    \u003cbutton \r\n      class=\"\r\n        tw-select-none \r\n        tw-mx-2 \r\n        tw-block\r\n        group-[.is-open]:tw-rotate-90\r\n        tw-transition-[transform] \r\n        tw-duration-500 \r\n        tw-ease-in-out\r\n        print:!tw-hidden\"\r\n      disabled\r\n      aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 320 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n    \u003cdiv class=\"code-block-title-bar tw-w-full\"\u003e\r\n      \u003cp class=\"tw-select-none !tw-my-1\"\u003exml\u003c/p\u003e\r\n    \u003c/div\u003e\r\n    \u003cdiv class=\"tw-flex\"\u003e\r\n      \u003cbutton \r\n        class=\"\r\n          line-number-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.show-line-numbers]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle line numbers\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M61.77 401l17.5-20.15a19.92 19.92 0 0 0 5.07-14.19v-3.31C84.34 356 80.5 352 73 352H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8h22.83a157.41 157.41 0 0 0-11 12.31l-5.61 7c-4 5.07-5.25 10.13-2.8 14.88l1.05 1.93c3 5.76 6.29 7.88 12.25 7.88h4.73c10.33 0 15.94 2.44 15.94 9.09 0 4.72-4.2 8.22-14.36 8.22a41.54 41.54 0 0 1-15.47-3.12c-6.49-3.88-11.74-3.5-15.6 3.12l-5.59 9.31c-3.72 6.13-3.19 11.72 2.63 15.94 7.71 4.69 20.38 9.44 37 9.44 34.16 0 48.5-22.75 48.5-44.12-.03-14.38-9.12-29.76-28.73-34.88zM496 224H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM16 160h64a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H64V40a8 8 0 0 0-8-8H32a8 8 0 0 0-7.14 4.42l-8 16A8 8 0 0 0 24 64h8v64H16a8 8 0 0 0-8 8v16a8 8 0 0 0 8 8zm-3.91 160H80a8 8 0 0 0 8-8v-16a8 8 0 0 0-8-8H41.32c3.29-10.29 48.34-18.68 48.34-56.44 0-29.06-25-39.56-44.47-39.56-21.36 0-33.8 10-40.46 18.75-4.37 5.59-3 10.84 2.8 15.37l8.58 6.88c5.61 4.56 11 2.47 16.12-2.44a13.44 13.44 0 0 1 9.46-3.84c3.33 0 9.28 1.56 9.28 8.75C51 248.19 0 257.31 0 304.59v4C0 316 5.08 320 12.09 320z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n\r\n      \u003cbutton \r\n        class=\"\r\n          wrap-code-button\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-hidden \r\n          group-[.is-open]:tw-block \r\n          group-[.is-wrap]:tw-text-fgColor-link \r\n          print:!tw-hidden\" \r\n        title=\"Toggle code wrap\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n      \r\n      \u003cbutton \r\n        class=\"\r\n          copy-code-button\r\n          tw-select-none\r\n          tw-mx-2 \r\n          tw-hidden\r\n          group-[.is-open]:tw-block\r\n          hover:tw-text-fgColor-link \r\n          print:!tw-hidden\"\r\n        title=\"Copy code\"\u003e\r\n          \u003cspan class=\"copy-icon tw-block\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n          \u003cspan class=\"check-icon tw-hidden\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/\u003e\u003c/svg\u003e\u003c/span\u003e\r\n      \u003c/button\u003e\r\n        \r\n      \u003cbutton \r\n        class=\"\r\n          tw-select-none \r\n          tw-mx-2 \r\n          tw-block \r\n          group-[.is-open]:tw-hidden \r\n          print:!tw-hidden\" \r\n        disabled\r\n        aria-hidden=\"true\"\u003e\u003csvg class=\"icon\"\n    xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"\u003e\u003c!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --\u003e\u003cpath d=\"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z\"/\u003e\u003c/svg\u003e\u003c/button\u003e\r\n    \u003c/div\u003e\r\n  \u003c/div\u003e\r\n  \u003cpre style=\"counter-reset: codeblock;\" class=\"tw-block tw-m-0 tw-p-0\"\u003e\u003ccode \r\n    id=\"codeblock-id-1\" \r\n    class=\"\r\n      chroma \r\n      !tw-block \r\n      tw-p-0\r\n      tw-m-0\r\n      tw-transition-[max-height] \r\n      tw-duration-500 \r\n      tw-ease-in-out \r\n      group-[.is-closed]:!tw-max-h-0 \r\n      group-[.is-wrap]:tw-text-wrap\r\n      tw-overflow-y-hidden\r\n      tw-overflow-x-auto\r\n      tw-scrollbar-thin\r\n      \"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e\u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;configuration\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;system.webServer\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nt\"\u003e\u0026lt;rewrite\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nt\"\u003e\u0026lt;rules\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nt\"\u003e\u0026lt;rule\u003c/span\u003e \u003cspan class=\"na\"\u003ename=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Disable Azure Domain\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003epatternSyntax=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Wildcard\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003estopProcessing=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;true\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nt\"\u003e\u0026lt;match\u003c/span\u003e \u003cspan class=\"na\"\u003eurl=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;*\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nt\"\u003e\u0026lt;conditions\u003c/span\u003e \u003cspan class=\"na\"\u003elogicalGrouping=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;MatchAll\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003etrackAllCaptures=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;false\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                                \u003cspan class=\"nt\"\u003e\u0026lt;add\u003c/span\u003e \u003cspan class=\"na\"\u003einput=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;{HTTP_HOST}\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003epattern=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;*.azurewebsites.net\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                            \u003cspan class=\"nt\"\u003e\u0026lt;/conditions\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                        \u003cspan class=\"nt\"\u003e\u0026lt;action\u003c/span\u003e \u003cspan class=\"na\"\u003etype=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Redirect\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eurl=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;http://www.mysite.com{REQUEST_URI}\u0026#34;\u003c/span\u003e \u003cspan class=\"na\"\u003eredirectType=\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Permanent\u0026#34;\u003c/span\u003e\u003cspan class=\"nt\"\u003e/\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                    \u003cspan class=\"nt\"\u003e\u0026lt;/rule\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                \u003cspan class=\"nt\"\u003e\u0026lt;/rules\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nt\"\u003e\u0026lt;/rewrite\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            ...\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nt\"\u003e\u0026lt;/system.webServer\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nt\"\u003e\u0026lt;/configuration\u0026gt;\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\r\n\u003c/div\u003e\r\n\u003cp\u003eSo why couldn\u0026rsquo;t I figure this last bit of magic out on my own\u0026hellip; I tried to set this up \u003cem\u003ebefore completing the other steps\u003c/em\u003e. Working on this yourself? Sort your Azure, DNS and WordPress config first!\u003c/p\u003e\n",
        "language": "en"
    },
    {
        "title" : "SfB HA SQL DAG Configuration",
        "date_published" : "2016-05-26T14:45:26+02:00",
        "date_modified" : "2016-05-26T14:45:26+02:00",
        "id" : "https://bearman.nl/2016/05/26/sfb-ha-sql-dag-configuration/",
        "url" : "https://bearman.nl/2016/05/26/sfb-ha-sql-dag-configuration/",
        "summary": "One of those silly mistakes… As mentioned in my previous post, I’ve recently installed and configured a new Skype for Business landscape at my company. While implementing this I made one of those silly mistakes that cause you to spend hours looking for a solution… which is in fact one simple undocumented configuration setting. For our SfB configuration we use a high availability SQL cluster and we’ve also set up a Database Availability Group, or DAG.",
        "content_html" : "\u003cp\u003e\u003cstrong\u003eOne of those silly mistakes…\u003c/strong\u003e As mentioned in my \u003ca href=\"https://bearman.nl/2016/05/24/customers-dont-have-a-frakking-clue/\" rel=\"\"\u003eprevious post\u003c/a\u003e, I’ve recently installed and configured a new Skype for Business landscape at my company. While implementing this I made one of those silly mistakes that cause you to spend hours looking for a solution… which is in fact one simple undocumented configuration setting. For our SfB configuration we use a high availability SQL cluster and we’ve also set up a Database Availability Group, or DAG. Once enabled, the first field gets relabeled ‘SQL Server Availability Group Listener FQDN’, the second ‘SQL Server FQDN’. Initially before enabling the DAG I set these values:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eField 1, SQL Server DAG FQDN;\u003c/li\u003e\n\u003cli\u003eField 2, any given SQL Server node FQDN which will become part of the DAG.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhich looks like this:\u003cbr\u003e\n\u003cimg class=\"tw-inline\" loading=\"lazy\" src=\"/2016/05/26/sfb-ha-sql-dag-configuration/DAG_Before.png\" srcset=\"/2016/05/26/sfb-ha-sql-dag-configuration/DAG_Before_hu17b7e1fb734a78195e779513aac511dd_77169_800x0_resize_q75_h2_box_3.webp 800w, /2016/05/26/sfb-ha-sql-dag-configuration/DAG_Before_hu17b7e1fb734a78195e779513aac511dd_77169_1200x0_resize_q75_h2_box_3.webp 1200w, /2016/05/26/sfb-ha-sql-dag-configuration/DAG_Before_hu17b7e1fb734a78195e779513aac511dd_77169_1600x0_resize_q75_h2_box_3.webp 1600w\" sizes=\"auto\" alt=\"DAG before\" height=\"429\" width=\"562\"\u003e\u003c/p\u003e\n\u003cp\u003eAfter the installation was complete and my published topology was running I ran into all sorts of problems, the root of which was the SQL datasource being read-only. Shortly after I determined the errors went away for a while when I switched the active node in the SQL cluster, so \u003cem\u003esomething\u003c/em\u003e had to be wrong with those settings… \u003cstrong\u003ebut what\u003c/strong\u003e?!\u003c/p\u003e\n\u003ch1 id=\"the-fix\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#the-fix\" class=\"header-mark\" aria-label=\"Header mark for 'The fix'\"\u003e\u003c/a\u003eThe fix\u003c/h1\u003e\u003cp\u003eSo what’s the correct configuration? After the initial installation of SfB \u003cem\u003eand\u003c/em\u003e finalizing the replication of all the databases for the SQL DAG, \u003cstrong\u003eyou need to change the SQL server FQDN back to the DAG FQDN.\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eField 1 requires, SQL Server DAG FQDN;\u003c/li\u003e\n\u003cli\u003eField 2 requires, SQL Server DAG FQDN.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg class=\"tw-inline\" loading=\"lazy\" src=\"/2016/05/26/sfb-ha-sql-dag-configuration/DAG_After.png\" srcset=\"/2016/05/26/sfb-ha-sql-dag-configuration/DAG_After_hu17202ef34e365d6b5c6f34fac0f7e78d_77472_800x0_resize_q75_h2_box_3.webp 800w, /2016/05/26/sfb-ha-sql-dag-configuration/DAG_After_hu17202ef34e365d6b5c6f34fac0f7e78d_77472_1200x0_resize_q75_h2_box_3.webp 1200w, /2016/05/26/sfb-ha-sql-dag-configuration/DAG_After_hu17202ef34e365d6b5c6f34fac0f7e78d_77472_1600x0_resize_q75_h2_box_3.webp 1600w\" sizes=\"auto\" alt=\"DAG after\" height=\"429\" width=\"562\"\u003e\u003c/p\u003e\n\u003cp\u003eWhy are there two fields for the same setting? You need to install the databases onto a single SQL node once before you can switch on the DAG settings, \u003cem\u003e\u003cstrong\u003ethen remember to reconfigure the SQL store in your SfB topology with the DAG FQDN\u003c/strong\u003e\u003c/em\u003e. Would be nice if the Microsoft documentation was explicit on the little things like these. One final tip, whenever you see a field that requires the \u003cstrong\u003eFQDN\u003c/strong\u003e, double check you \u003cem\u003eactually used the FQDN\u003c/em\u003e before publishing your topology. Changing the FQDN on the SQL Server store after the topology has been published can be a chore…\u003c/p\u003e\n",
        "language": "en"
    },
    {
        "title" : "Customers Dont Have a Frakking Clue",
        "date_published" : "2016-05-24T06:45:03+02:00",
        "date_modified" : "2016-05-24T06:45:03+02:00",
        "id" : "https://bearman.nl/2016/05/24/customers-dont-have-a-frakking-clue/",
        "url" : "https://bearman.nl/2016/05/24/customers-dont-have-a-frakking-clue/",
        "summary": "Part 1: The origin story\nThe origin storyAs a consultant in the IT industry it is expected to have a thorough understanding of all IT related products in one’s portfolio. When considering what these solutions are intended to provide, we all know the problems our customers face. Right? Wrong. Often enough I’ve heard colleagues in IT mention customers don’t have a clue and vice versa. What everyone should consider is that we’re both wrong unless we listen to each other!",
        "content_html" : "\u003cp\u003ePart 1: The origin story\u003c/p\u003e\n\u003ch3 id=\"the-origin-story\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#the-origin-story\" class=\"header-mark\" aria-label=\"Header mark for 'The origin story'\"\u003e\u003c/a\u003eThe origin story\u003c/h3\u003e\u003cp\u003eAs a consultant in the IT industry it is expected to have a thorough understanding of all IT related products in one’s portfolio. When considering what these \u003cem\u003esolutions\u003c/em\u003e are intended to provide, we all know the \u003cem\u003eproblems\u003c/em\u003e our customers face. Right? \u003cstrong\u003eWrong.\u003c/strong\u003e Often enough I’ve heard colleagues in IT mention customers don’t have a clue and vice versa. What everyone should consider is that we’re both wrong unless we listen to each other! Most often customers find me through channels related to the solutions we offer, but the very first question I ask all customers is, ‘Why do you want this product?’ The problem they describe is usually a business related concept and through the years I’ve come to understand \u003cem\u003ebusiness concepts and problems\u003c/em\u003e. Recently when I came to work for my new employer, Silverside, I was asked to set up a new on premise server deployment of Skype for Business. Naturally my first question was, ‘Why? What’s the problem?’ At which my new colleague grinned, ‘Funny you should ask, we’d like to implement the business scenario \u003cem\u003e\u003cstrong\u003eSmarter Meetings\u003c/strong\u003e\u003c/em\u003e .’ It might seem counter intuitive to question a customer asking to buy the product you’re selling. What I’ve discovered is a process of defining solutions without including the product. Do we still sell those same products? Yes, we do. Does this change the products themselves? No, it doesn’t. Does this help me sell more of my products and services? Not \u003cem\u003eat first\u003c/em\u003e.\u003c/p\u003e\n\u003ch3 id=\"the-concept\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#the-concept\" class=\"header-mark\" aria-label=\"Header mark for 'The concept'\"\u003e\u003c/a\u003eThe concept\u003c/h3\u003e\u003cp\u003eBy being honest both to our customers and to ourselves we are able to find the best solution for our customers. In turn our customers value our opinion even more and are more likely to return to us for future services. Seeking a partnership like this can be challenging at first, as steering a customer away from our services does not directly support our business. In the long run however I’ve built more lasting and rewarding partnerships in this manner than any other. Back to our concrete example of Smarter Meetings. My current project involves getting all our colleagues to stop and think about the way we communicate together. Am I implementing Skype for Business as a part of it? Yes, I might be. The first question when announcing to implement Skype for Business however boiled down to this, ‘A new product is not going to change the way we do things, why change a winning team?’ When we announced that we’re implementing a smarter way of having our meetings, the first question was one of pure interest, ‘How would we do that?’ This isn’t a new way of thinking necessarily, yet forcing both ourselves and our customers to work toward a common goal and \u003cem\u003ewanting\u003c/em\u003e to find a solution together is. Key points to keep in mind in this trend are, - Nothing is sacred, be open to new ideas. This includes \u003cem\u003eyou\u003c/em\u003e, the consultant! - Find common goals, truly \u003cem\u003ewant\u003c/em\u003e to achieve them. - Agree on how to get there. - Offer your product if it fits, but don’t be afraid to offer alternatives if it doesn’t.\u003c/p\u003e\n\u003ch3 id=\"skype-for-business\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#skype-for-business\" class=\"header-mark\" aria-label=\"Header mark for 'Skype for Business'\"\u003e\u003c/a\u003eSkype for Business\u003c/h3\u003e\u003cp\u003eSo why are we using Skype for Business to promote the concept of Smarter Meetings at Silverside? As a company we used to be addicted to phones, emails and paper notes. We traveled the world, literally spending 8 hours a day flying or driving to common locations simply to meet face to face. Now we’ve set out to change that mindset by tackling the following concepts: - By far the behavior most in need of change is our use of phones. Pointing out monthly phone bills racking up to €500, - a month was a real eye opener for some of our colleagues. - Most of us are familiar with the use of paper, drawing out what you’re trying to say is sometimes just that much more comfortable. Most assume there is no digital equivalent, but have you ever used a whiteboard in a Skype meeting? - In person meetings provide more feedback about the other person in the room, body language, micro expressions, etc. However, we’ve committed to using a Microsoft Surface Hub together with high definition cameras to ensure we have a virtual presence with which we can interact in a natural way using touch. But what are we really using Skype for Business for? To jog our customers (and colleagues) out of a rusty paradigm where the best solution is to keep working as we have been for years. Stop. Think about the way you’re doing things today. Is there another way of doing these things that might be better and/or cheaper? Don’t hesitate and choose to find this path together with your customers.\u003c/p\u003e\n\u003ch3 id=\"conclusion\" class=\"headerLink\"\u003e\r\n    \u003ca href=\"#conclusion\" class=\"header-mark\" aria-label=\"Header mark for 'Conclusion'\"\u003e\u003c/a\u003eConclusion\u003c/h3\u003e\u003cp\u003eIT consultants should truly listen to the customer and try to find the actual problem. We’re literally getting paid for it so: - Take 5 minutes to listen silently, nod every so often, take notes. - Summarize what you’ve just heard explicitly and *ask for confirmation. *- Be patient and give the customer the idea they’re money is being well spent. The morale of this story is most IT consultants think they know better than their customers, while customers think consultants aren’t really listening to what they’re saying. A lot of brilliant IT techies could become brilliant consultant if they want to. This is the first in a series where I’ll be shedding some light on the non-technical aspects of IT consultancy, the part of our industry that can usually do with a virtual prod in the rear towards the future. Stay tuned for more stories from \u003ca href=\"https://twitter.com/bearmannl\" target=\"_blank\" rel=\"noopener noreferrer\"\u003e@BearmanNL\u003c/a\u003e…\u003c/p\u003e\n",
        "language": "en"
    },
    ]
}
